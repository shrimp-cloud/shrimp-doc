# 公众号接入

> 此文档引导应用接入微信公众号，公众号端的配置


## 账号材料

- 位置: 【账号】/账号详情/公开信息
- 配置内容及说明
  - 头像维护
  - 名称维护
  - 二维码: 可下载之后用于引流
  - 认证情况: 必需经过认证，才能继续开展业务
  - 服务类目: 涉及到账号可开通哪些功能。开通时，需要相关材料


## 授权

> 为使得开发者能顺便的配置公众号，需要给开发者授权

- 位置: 设置与开发/开发接口管理/开发者工具/web开发者工具
- 操作: 将开发者的微信，添加到开发者列表中



## 账号账号开发信息


- 位置：设置与开发/开发接口管理/基本配置/账号开发信息
- 配置内容及说明
  - 开发者ID(AppID): 摘录，并配置到服务内
  - 开发者密码(AppSecret): 启用，并配置到服务内
  - IP 白名单配置: 添加服务器的 IP(范围)，此IP范围，由开发者，或相关运维提供 (配置之后，只能在 安全中心 中查看)


## 服务器配置

- 位置: 设置与开发/开发接口管理/基本配置/服务器配置
- 配置内容及说明
  - 状态: 启用
  - 服务器地址(URL): https://api.example.com/public/wxmp/portal/{appId} (已脱敏,实际配置请联系开发者)
  - 令牌(Token): 随便生成 32 位长度的token, 并配置到服务内
  - 消息加解密密钥 (EncodingAESKey): 随便生成
  - 消息加解密方式: 安全模式
- 配置过程
  - 以上信息预填写之后，需要在应用内配置，上述内容才能验证通过

## 账号设置

- 位置: 设置与开发/账号设置/功能设置
- 配置内容及说明(是否强制 https 均可)
  - 业务域名： 进行业务活动的域名
  - JS接口安全域名: 需要调用 JS 接口的域名
  - 网页授权域名: 需要让用户进行授权跳转的域名
- 配置过程
  - 正常情况下，三个域名均配置成一致即可：wxmp.example.com
  - 将配置界面的验证文件，给开发者配置到公众号的静态根目录下，即可完成域名的验证


## 模板消息

- 位置: 广告与服务/模板消息/我的模板
- 配置内容及说明
  - 前提: 确认配置了服务类目。不同类目可用的消息模板是不同的
  - 模板库：找到自己想要的模板，并选择模板包含的内容。
  - 模板ID: 获取模板ID, 并配置在项目后台，此 ID 将用于推送消息
  - 模板变量: 模板变量，将会被真实内容填充，需要明确的变量名

## 素材

- 位置: 内容管理 / 素材库 / 图片
- 配置内容及说明
  - 上传素材
  - 获取素材 ID (通过接口获取)
  - 将素材使用到相关功能上 (如自动回复)


## 项目维护

- appId 设置：需要将 appId 内置到公众号项目内，用于项目授权
  - saas 化的情况: 前端域名，自动从后端获取 appId
- 公众号配置
  - 配置完成需重启以重新加载配置信息
- 菜单推送
  - 需要将菜单信息推送到公众号的聊天窗口
